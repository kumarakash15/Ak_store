<% layout("/layout/bollerplate") %>

<body class="bg-light">

<!-- ================= PRODUCTS + PRICE ================= -->
<div class="container py-4">
  <div class="row">

    <!-- ðŸ›’ PRODUCTS -->
    <div class="col-md-7">
      <% let totalAmount = 0; %>

      <% cartItems.forEach(item => { %>
        <% 
          const product = item.productId;
          const itemTotal = product.current_price * item.quantity;
          totalAmount += itemTotal;
        %>

        <div class="card p-3 shadow-sm mb-3">
          <div class="row align-items-center">
            <div class="col-md-4">
              <img src="<%= product.image %>" class="img-fluid rounded">
            </div>

            <div class="col-md-8">
              <h6 class="fw-bold mb-1"><%= product.company %></h6>
              <p class="text-muted mb-1"><%= product.item_name %></p>

              <h5 class="mb-1">
                â‚¹<%= product.current_price %>
                <span class="text-muted fs-6">
                  <del>â‚¹<%= product.original_price %></del>
                </span>
                <span class="text-success fs-6 fw-bold">
                  (<%= product.discount_percentage %>% OFF)
                </span>
              </h5>

              <p class="mb-1">Qty: <strong><%= item.quantity %></strong></p>
              <p class="fw-bold mb-0">Item Total: â‚¹<%= itemTotal %></p>
            </div>
          </div>
        </div>
      <% }) %>
    </div>

    <!-- ðŸ’° PRICE DETAILS -->
    <div class="col-md-5">
      <div class="card shadow-sm p-3">
        <h5 class="fw-bold mb-3">PRICE DETAILS</h5>

        <div class="d-flex justify-content-between mb-2">
          <span>Total Items</span>
          <span><%= cartItems.length %></span>
        </div>

        <div class="d-flex justify-content-between mb-2">
          <span>Delivery Charges</span>
          <span class="text-success fw-bold">FREE</span>
        </div>

        <hr>

        <div class="d-flex justify-content-between fw-bold fs-5">
          <span>Total Amount</span>
          <span>â‚¹<%= totalAmount %></span>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ================= DELIVERY DETAILS ================= -->
<div class="container mb-5">
  <div class="card shadow-sm p-4">
    <h5 class="fw-bold mb-3">DELIVERY DETAILS</h5>

    <!-- ðŸ”¥ IMPORTANT PART -->
    <form id="cartBuyForm" action="/checkout" method="POST">

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="fw-bold">Full Name</label>
          <input type="text" name="name" class="form-control" required>
        </div>

        <div class="col-md-6 mb-3">
          <label class="fw-bold">Mobile Number</label>
          <input type="tel" name="mobile" class="form-control" maxlength="10" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="fw-bold">State</label>
          <input type="text" name="state" class="form-control" required>
        </div>

        <div class="col-md-6 mb-3">
          <label class="fw-bold">City</label>
          <input type="text" name="city" class="form-control" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="fw-bold">Pincode</label>
          <input type="text" name="pincode" class="form-control" maxlength="6" required>
        </div>

        <div class="col-md-6 mb-3">
          <label class="fw-bold">Locality</label>
          <input type="text" name="locality" class="form-control" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="fw-bold">House / Street</label>
          <input type="text" name="house" class="form-control" required>
        </div>

        <div class="col-md-6 mb-3">
          <label class="fw-bold">Landmark (Optional)</label>
          <input type="text" name="landmark" class="form-control">
        </div>
      </div>

    </form>
  </div>
</div>

<!-- ================= PLACE ORDER ================= -->
<div class="fixed-bottom bg-white shadow-lg p-3 text-end">
  <button type="submit" form="cartBuyForm" class="btn btn-success px-5 py-2 fs-5">
    PLACE ORDER
  </button>
</div>
</body>